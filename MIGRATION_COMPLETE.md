# æ•°æ®åº“æŠ½è±¡å±‚è¿ç§»å®Œæˆ âœ…

## å®Œæˆçš„å·¥ä½œ

### 1. âœ… åˆ›å»ºæ•°æ®åº“æ¥å£å®šä¹‰
- æ–‡ä»¶ï¼š`server/db/types.ts`
- å®šä¹‰äº†æ‰€æœ‰æ•°æ®å®ä½“ç±»å‹ï¼ˆCategory, Todo, FileRecord, Reminderï¼‰
- å®šä¹‰äº†è¾“å…¥ç±»å‹ï¼ˆCreateXxxInput, UpdateXxxInputï¼‰
- å®šä¹‰äº† DatabaseAdapter æ¥å£ï¼Œè§„èŒƒæ‰€æœ‰é€‚é…å™¨çš„å®ç°

### 2. âœ… å®ç° SQLite é€‚é…å™¨
- æ–‡ä»¶ï¼š`server/db/adapters/sqlite.ts`
- å°è£…äº†åŸæœ‰çš„ SQLite æ•°æ®åº“æ“ä½œ
- å®ç°äº† DatabaseAdapter æ¥å£çš„æ‰€æœ‰æ–¹æ³•
- ä¿ç•™äº†æ•°æ®åº“åˆå§‹åŒ–å’Œé»˜è®¤åˆ†ç±»æ’å…¥é€»è¾‘

### 3. âœ… å®ç° Supabase é€‚é…å™¨
- æ–‡ä»¶ï¼š`server/db/adapters/supabase.ts`
- å®ç°äº† DatabaseAdapter æ¥å£çš„æ‰€æœ‰æ–¹æ³•
- ä½¿ç”¨ @supabase/supabase-js å®¢æˆ·ç«¯åº“
- æ­£ç¡®å¤„ç†äº† PostgreSQL å’Œ SQLite çš„å·®å¼‚ï¼ˆå¦‚å¸ƒå°”å€¼ã€è‡ªå¢ ID ç­‰ï¼‰

### 4. âœ… åˆ›å»ºæ•°æ®åº“å·¥å‚
- æ–‡ä»¶ï¼š`server/db/index.ts`
- æ ¹æ®ç¯å¢ƒå˜é‡ `DB_TYPE` è‡ªåŠ¨é€‰æ‹©é€‚é…å™¨
- é»˜è®¤ä½¿ç”¨ SQLiteï¼Œå¯åˆ‡æ¢åˆ° Supabase
- æä¾›ç»Ÿä¸€çš„ `db` å¯¼å‡ºå¯¹è±¡

### 5. âœ… æ›´æ–°æ‰€æœ‰ API è·¯ç”±
- æ–‡ä»¶ï¼š`src/index.ts`
- å°†æ‰€æœ‰ç›´æ¥ SQL æŸ¥è¯¢æ›¿æ¢ä¸ºé€‚é…å™¨æ–¹æ³•è°ƒç”¨
- æ‰€æœ‰æ“ä½œæ”¹ä¸ºå¼‚æ­¥ï¼ˆä½¿ç”¨ awaitï¼‰
- ID å‚æ•°æ­£ç¡®è½¬æ¢ä¸ºæ•°å­—ç±»å‹

### 6. âœ… æ·»åŠ é…ç½®æ”¯æŒ
- åˆ›å»º `.env.example` æ–‡ä»¶
- åˆ›å»º `server/db/supabase-migration.sql` Supabase è¿ç§»è„šæœ¬
- æ›´æ–° `package.json` æ·»åŠ  @supabase/supabase-js ä¾èµ–

### 7. âœ… æ›´æ–°æ–‡æ¡£
- æ›´æ–° `README.md` - æ·»åŠ æ•°æ®åº“é…ç½®ç« èŠ‚
- æ›´æ–° `.github/copilot-instructions.md` - æ›´æ–°æŠ€æœ¯æ ˆå’Œç¼–ç å»ºè®®
- åˆ›å»º `server/db/README.md` - è¯¦ç»†çš„æ•°æ®åº“æŠ½è±¡å±‚ä½¿ç”¨æŒ‡å—

## æ¶æ„ä¼˜åŠ¿

### ğŸ¯ è§£è€¦æ€§
ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®å­˜å‚¨å®Œå…¨åˆ†ç¦»ï¼Œåˆ‡æ¢æ•°æ®åº“æ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç 

### ğŸ”’ ç±»å‹å®‰å…¨
TypeScript æ¥å£ç¡®ä¿æ‰€æœ‰é€‚é…å™¨å®ç°ä¸€è‡´çš„ API

### ğŸ”„ æ˜“åˆ‡æ¢
åªéœ€ä¿®æ”¹ç¯å¢ƒå˜é‡å³å¯åˆ‡æ¢æ•°æ®åº“

### ğŸ“ˆ æ˜“æ‰©å±•
æ·»åŠ æ–°æ•°æ®åº“åªéœ€å®ç° DatabaseAdapter æ¥å£

### âœ… å¯æµ‹è¯•
å¯ä»¥è½»æ¾åˆ›å»º Mock é€‚é…å™¨è¿›è¡Œå•å…ƒæµ‹è¯•

## ä½¿ç”¨æŒ‡å—

### é»˜è®¤ä½¿ç”¨ SQLiteï¼ˆæ— éœ€é…ç½®ï¼‰
```bash
bun dev
```

### åˆ‡æ¢åˆ° Supabase
1. åˆ›å»º `.env` æ–‡ä»¶ï¼š
```bash
DB_TYPE=supabase
SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_KEY=your-anon-key
```

2. åœ¨ Supabase SQL Editor è¿è¡Œ `server/db/supabase-migration.sql`

3. å¯åŠ¨åº”ç”¨ï¼š
```bash
bun install  # å®‰è£… Supabase ä¾èµ–
bun dev
```

### åœ¨ä»£ç ä¸­ä½¿ç”¨
```typescript
import { db } from "../server/db";

// æ‰€æœ‰æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„
const todos = await db.getAllTodos();
const newTodo = await db.createTodo({ title: "æ–°ä»»åŠ¡" });
const updated = await db.updateTodo(1, { completed: true });
await db.deleteTodo(1);
```

## æ–‡ä»¶å˜æ›´æ¸…å•

### æ–°å¢æ–‡ä»¶
- âœ… `server/db/types.ts` - æ•°æ®åº“æ¥å£å®šä¹‰
- âœ… `server/db/adapters/sqlite.ts` - SQLite é€‚é…å™¨
- âœ… `server/db/adapters/supabase.ts` - Supabase é€‚é…å™¨
- âœ… `server/db/supabase-migration.sql` - Supabase è¿ç§»è„šæœ¬
- âœ… `server/db/README.md` - æ•°æ®åº“æŠ½è±¡å±‚æ–‡æ¡£
- âœ… `.env.example` - ç¯å¢ƒå˜é‡ç¤ºä¾‹

### ä¿®æ”¹æ–‡ä»¶
- âœ… `server/db/index.ts` - æ”¹ä¸ºæ•°æ®åº“å·¥å‚æ¨¡å¼
- âœ… `src/index.ts` - æ‰€æœ‰ API è·¯ç”±æ”¹ç”¨é€‚é…å™¨æ–¹æ³•
- âœ… `package.json` - æ·»åŠ  @supabase/supabase-js ä¾èµ–
- âœ… `README.md` - æ·»åŠ æ•°æ®åº“é…ç½®è¯´æ˜
- âœ… `.github/copilot-instructions.md` - æ›´æ–°å¼€å‘æŒ‡å—

## ä¸‹ä¸€æ­¥

### å¯é€‰ä¼˜åŒ–
1. æ·»åŠ æ•°æ®åº“è¿æ¥æ± ç®¡ç†
2. å®ç°æ•°æ®åº“æŸ¥è¯¢æ—¥å¿—
3. æ·»åŠ æ•°æ®åº“æ€§èƒ½ç›‘æ§
4. å®ç°æ•°æ®è¿ç§»å·¥å…·ï¼ˆSQLite â†” Supabaseï¼‰
5. æ·»åŠ æ›´å¤šæ•°æ®åº“é€‚é…å™¨ï¼ˆMySQL, PostgreSQL, MongoDBï¼‰

### æµ‹è¯•å»ºè®®
1. æµ‹è¯• SQLite æ¨¡å¼ä¸‹æ‰€æœ‰åŠŸèƒ½
2. æµ‹è¯• Supabase æ¨¡å¼ä¸‹æ‰€æœ‰åŠŸèƒ½
3. æµ‹è¯•æ•°æ®åº“åˆ‡æ¢æµç¨‹
4. éªŒè¯é”™è¯¯å¤„ç†é€»è¾‘

## æ³¨æ„äº‹é¡¹

âš ï¸ **TypeScript é”™è¯¯**  
å¦‚æœçœ‹åˆ° `@supabase/supabase-js` æ¨¡å—æ‰¾ä¸åˆ°çš„é”™è¯¯ï¼Œè¿™æ˜¯ç¼–è¾‘å™¨ç¼“å­˜é—®é¢˜ã€‚å®é™…ä¾èµ–å·²æ­£ç¡®å®‰è£…ï¼Œè¿è¡Œæ—¶ä¸ä¼šæœ‰é—®é¢˜ã€‚å¯ä»¥é‡å¯ VS Code æˆ–é‡è½½çª—å£è§£å†³ã€‚

âš ï¸ **ç¯å¢ƒå˜é‡**  
ç”Ÿäº§ç¯å¢ƒè®°å¾—åˆ›å»º `.env` æ–‡ä»¶ï¼ˆä¸è¦æäº¤åˆ° Gitï¼‰

âš ï¸ **Supabase RLS**  
Supabase è¿ç§»è„šæœ¬ä¸­çš„è¡Œçº§å®‰å…¨ç­–ç•¥(RLS)é»˜è®¤æ˜¯æ³¨é‡Šçš„ï¼Œæ ¹æ®éœ€è¦å¯ç”¨

## æ€»ç»“

æˆåŠŸå°†é¡¹ç›®ä»ç›´æ¥ä½¿ç”¨ SQLite è¿ç§»åˆ°**æ•°æ®åº“æŠ½è±¡å±‚æ¶æ„**ï¼

ç°åœ¨é¡¹ç›®å…·å¤‡äº†ï¼š
- âœ… **çµæ´»æ€§** - å¯éšæ—¶åˆ‡æ¢æ•°æ®åº“
- âœ… **å¯æ‰©å±•æ€§** - è½»æ¾æ·»åŠ æ–°æ•°æ®åº“æ”¯æŒ  
- âœ… **å¯ç»´æŠ¤æ€§** - ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®å­˜å‚¨è§£è€¦
- âœ… **å‘åå…¼å®¹** - ä¿ç•™ SQLite ä½œä¸ºé»˜è®¤é€‰é¡¹
- âœ… **ç±»å‹å®‰å…¨** - TypeScript æ¥å£ä¿è¯ä¸€è‡´æ€§

ğŸ‰ è¿ç§»å®Œæˆï¼
